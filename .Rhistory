autodep=TRUE,
fig.align="center",
comment="")
library(SummarizedExperiment)
thca <- readRDS("seTHCA.rds")
library(knitr)
opts_chunk$set(cache=TRUE,
cache.path="cache/QA",
cache.extra=R.version.string,
autodep=TRUE,
fig.align="center",
comment="")
library(SummarizedExperiment)
thca <- readRDS("seTHCA.rds")
library(knitr)
opts_chunk$set(cache=TRUE,
cache.path="cache/QA",
cache.extra=R.version.string,
autodep=TRUE,
fig.align="center",
comment="")
library(SummarizedExperiment)
thca <- readRDS("seTHCA.rds")
thca
dim(colData(thca))
colData(thca)[1:5, 1:5]
mcols(colData(thca), use.names=TRUE)
metadata(thca)
rowData(thca)
rowRanges(thca)
library(edgeR)
dge <- DGEList(counts=assays(thca)$counts, genes=mcols(thca))
saveRDS(dge, file.path("./", "dge.rds"))
assays(thca)$logCPM <- cpm(dge, log=TRUE, prior.count=0.5)
assays(thca)$logCPM[1:5, 1:5]
ord <- order(dge$sample$lib.size/1e6)
barplot(dge$sample$lib.size[ord]/1e6, las=1, ylab="Millions of reads",
xlab="Samples", col=c("red", "blue")[(thca$type[ord] == "tumor") + 1], border = NA)
legend("topleft", c("tumor", "normal"), fill=c("blue", "red"), inset=0.01)
barplot(thca$type == "tumor")
plot_numbers(thca$type)
barplot(thca$type)
barplot(thca$type, las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
barplot(dge$sample$type, las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
library("DEP")
BiocLite("DEP")
libarary("BiocLite")
library(BiocLite)
library(DEP)
library(BiocInstaller)
biocLite("DEP")
summary(thca$sex)
library("DEP")
remove.packages(,"DEP")
remove.packages(all,"DEP")
summary(thca$sex)
plot_numbers(thca$type)
summary(thca$sex)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
summary(thca$sex)
summary(thca)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
assay(thca$sex)
thca$sex
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
dge$sex
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
dge
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
thca
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
colData(sex)
colData(thca)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
str(colData(thca))
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
colData(thca)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
colData(thca)$sex
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
colData(thca)$type
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
colData(thca)$type
summary(colData(thca)$type)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
#colData(thca)$type
summary(colData(thca)$type)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
#colData(thca)$type
colnames(thca)
summary(colData(thca)$type)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
#colData(thca)$type
colnames(colData(thca))
summary(colData(thca)$type)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
summary(colData(thca)$type)
summary(colData(thca)$gender)
summary(colData(thca)$ethnicity)
summary(colData(thca)$age_at_diagnosis)
summary(colData(thca)$histological_type)
summary(colData(thca)$menopause_status)
summary(colData(thca)$tumor_type)
summary(colData(thca)$tumor_level)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
summary(colData(thca)$type)
summary(colData(thca)$gender)
summary(colData(thca)$ethnicity)
summary(colData(thca)$age_at_diagnosis)
summary(colData(thca)$histological_type)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
summary(colData(thca)$type)
summary(colData(thca)$gender)
summary(colData(thca)$ethnicity)
summary(colData(thca)$age_at_diagnosis)
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
summary(colData(thca)$type)
summary(colData(thca)$gender)
summary(colData(thca)$ethnicity)
summary(colData(thca)$age_at_diagnosis)
barplot(colData(thca)$type)
summary(colData(thca)$type)
summary(colData(thca)$gender)
summary(colData(thca)$ethnicity)
summary(colData(thca)$age_at_diagnosis)
barplot(summary(colData(thca)$type))
barplot(dge$sample$type[thca], las=1, ylab="Number of samples", xlab="Type of sample", col=c("red", "blue")[(thca$type[thca] == "tymor") + 1], border = NA)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
age <- cut(summary(colData(thca)$age_at_diagnosis), braks = c(-Inf, 20, 30, 40, 50, 60, Inf), labels = c("0-20", "21-30", "31-40", "41-50", "51-60", "61-older"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
age <- cut(colData(thca)$age_at_diagnosis, braks = c(-Inf, 20, 30, 40, 50, 60, Inf), labels = c("0-20", "21-30", "31-40", "41-50", "51-60", "61-older"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
age <- cut(colData(thca)$age_at_diagnosis, braks = c(0, 20, 30, 40, 50, 60, 100), labels = c("0-20", "21-30", "31-40", "41-50", "51-60", "61-older"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
age <- cut(colData(thca)$age_at_diagnosis, braks=c(0, 20, 30, 40, 50, 60, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-older"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
age <- cut(colData(thca)$age_at_diagnosis, braks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
age <- cut(colData(thca)$age_at_diagnosis, breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(colData(thca)$age_at_diagnosis))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(age)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
barplot(cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(age)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
colData(thca)$age_at_diagnosis2) <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
assays(colData(thca)$age_at_diagnosis2)) <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
assays(colData(thca))$age_at_diagnosis2) <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(age)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
barplot(cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(age)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(age)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
as.vector(age)
barplot(age)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
class(age)
as.vector(age)
barplot(age)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
class(age)
as.vector(age)
class(age)
barplot(age)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
class(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
class(age)
barplot(age)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
summary(age)
class(age)
barplot(age)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 80, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-80", "81-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 20, 30, 40, 50, 60, 80, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-80", "81-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
#assays(colData(thca))$age_at_diagnosis2) <-
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(1, 20, 30, 40, 50, 60, 80, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-80", "81-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(1, 20, 30, 40, 50, 60, 80, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-80", "81-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 1, 20, 30, 40, 50, 60, 80, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-80", "81-100"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 1, 20, 30, 40, 50, 60, 80, 100), labels=c("NA", "0-20", "21-30", "31-40", "41-50", "51-60", "61-80", "81-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100, NA's), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(0, 20, 30, 40, 50, 60, 90, 100, NA), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 20, 30, 40, 50, 60, 90, Inf, NA), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 20, 30, 40, 50, 60, 90, NA), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 20, 30, 40, 50, 60, 90, 100, NA), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 20, 30, 40, 50, 60, 90, 100, NA), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right = FALSE)
summary(age)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 20, 30, 40, 50, 60, 90, 100, NA), labels=c("0-20", "21-30", "31-40", "41-50", "51-60", "61-90", "91-100"), right=FALSE)
summary(age)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 20, 30, 40, 50, 60, 90, 100), labels=c("0-19", "20-29", "30-39", "40-49", "50-59", "60-89", "90-100"), right=FALSE)
summary(age)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
summary(cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 20, 30, 40, 50, 60, 90, 100), labels=c("0-19", "20-29", "30-39", "40-49", "50-59", "60-89", "90-100"), right=FALSE))
summary(age)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 20, 30, 40, 50, 60, 90, 100), labels=c("0-19", "20-29", "30-39", "40-49", "50-59", "60-89", "90-100"), right=FALSE)
summary(age)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 20, 30, 40, 50, 60, 90, 100, NA), labels=c("0-19", "20-29", "30-39", "40-49", "50-59", "60-89", "90-100", "NA"), right=FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(NA, 0, 20, 30, 40, 50, 60, 90, 100), labels=c("0-19", "20-29", "30-39", "40-49", "50-59", "60-89", "90-100"), right=FALSE)
summary(age)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(NA, 0, 20, 30, 40, 50, 60, 90, 100), labels=c("NA", "0-19", "20-29", "30-39", "40-49", "50-59", "60-89", "90-100"), right=FALSE)
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
summary(colData(thca)$age_at_diagnosis)
age <- cut(summary(colData(thca)$age_at_diagnosis), breaks=c(-Inf, 0, 20, 30, 40, 50, 60, 90, 100), labels=c("NA", "0-19", "20-29", "30-39", "40-49", "50-59", "60-89", "90-100"), right=FALSE)
summary(age)
barplot(summary(age))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
ord <- order(dge$sample$lib.size/1e6)
barplot(dge$sample$lib.size[ord]/1e6, las=1, ylab="Millions of reads",
xlab="Samples", col=c("red", "blue")[(thca$type[ord] == "tumor") + 1], border = NA)
legend("topleft", c("tumor", "normal"), fill=c("blue", "red"), inset=0.01)
sampledepth <- round(dge$sample$lib.size / 1e6, digits=1)
names(sampledepth) <- substr(colnames(thca), 6, 12)
sort(sampledepth)
maskd <- sampledepth > 40 #sample depth filter
maskg <- !is.na(thca$gender) #gender filter
dim(thca)
thca.filt <- thca[maskd,maskg]
dge.filt <- dge[maskd,maskg]
dim(thca.filt)
library(geneplotter)
par(mfrow=c(1, 2))
multidensity(as.list(as.data.frame(assays(thca.filt[, thca.filt$type == "tumor"])$logCPM)),
xlab="log 2 CPM", legend=NULL, main="Tumor samples", las=1)
multidensity(as.list(as.data.frame(assays(thca.filt[, thca.filt$type == "normal"])$logCPM)),
xlab="log 2 CPM", legend=NULL, main="Normal samples", las=1)
par(mfrow=c(2, 2))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
par(mfrow=c(2, 2))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
par(mfrow=c(2, 2))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
par(mfrow=c(2, 2))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
par(mfrow=c(2, 2))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
par(mfrow=c(2, 2))
barplot(summary(colData(thca)$type))
barplot(summary(colData(thca)$gender))
barplot(summary(colData(thca)$ethnicity))
barplot(summary(colData(thca)$age_at_diagnosis))
sampledepth <- dge$sample$lib.size[ord]/1e6
#sampledepth <- round(dge$sample$lib.size / 1e6, digits=1)
names(sampledepth) <- substr(colnames(thca), 6, 12)
sort(sampledepth)
sampledepth <- round(dge$sample$lib.size[ord]/1e6, digits=1)
#sampledepth <- round(dge$sample$lib.size / 1e6, digits=1)
names(sampledepth) <- substr(colnames(thca), 6, 12)
sort(sampledepth)
maskd <- sampledepth > 40 #sample depth filter
maskg <- !is.na(thca$gender) #gender filter
dim(thca)
thca.filt <- thca[maskd,maskg]
dge.filt <- dge[maskd,maskg]
dim(thca.filt)
maskd <- sampledepth > 40 #sample depth filter
#maskg <- !is.na(thca$gender) #gender filter
dim(thca)
#thca.filt <- thca[maskd,maskg]
#dge.filt <- dge[maskd,maskg]
thca.filt <- thca[maskd]
dge.filt <- dge[maskd]
maskd <- sampledepth > 40 #sample depth filter
#maskg <- !is.na(thca$gender) #gender filter
dim(thca)
#thca.filt <- thca[maskd,maskg]
#dge.filt <- dge[maskd,maskg]
thca.filt <- thca[maskd,]
dge.filt <- dge[maskd,]
dim(thca.filt)
ord.filt <- order(dge.filt$sample$lib.size/1e6)
barplot(dge.filt$sample$lib.size[ord.filt]/1e6, las=1, ylab="Millions of reads",
xlab="Samples", col=c("red", "blue")[(thca$type[ord] == "tumor") + 1], border = NA)
legend("topleft", c("tumor", "normal"), fill=c("blue", "red"), inset=0.01)
